<p align="center">
  <img src="https://user-images.githubusercontent.com/78009407/126273326-662b5aff-034f-4f48-a62a-69552195ff86.png" />
</p>

[![Contributors][contributors-shield]][contributors-url]
[![Stargazers][stars-shield]][stars-url]
[![Issues][issues-shield]][issues-url]
[![MIT License][license-shield]][license-url]

## Purpose
This repository holds the code and the supporting files to convert SPARC data into NWB format using Python. The repository uses [PyNWB](https://pynwb.readthedocs.io/en/stable/) package. Instructions are provided below to run the code and convert datasets from sparc to NWB format.

## Usage
1. Create a folder named `data` and drop the SPARC dataset in the data folder.
2. The dependencies required to run the python script are in `requirments.txt`. Install the dependencies.
```shell
python3 -m pip install requirements.txt
```
3. Change the `standard_path` and `filename` vairables in the main function to get the data and save the NWB files respectively.
4. Run the python script.
```shell
python3 sparc_to_nwb.py
```

## Conversion of SPARC Data to NWB Data
<ol>
<li>The above research paper was used as baseline for conversion of SPARC data to NWB format.</li>
<li>The NWB file was fed with the metadata information regarding the subject. The metadata information includes age, genotype, subject id, sex, weight, species, and description.
<ol>
  <li>
    The metadata information is extracted from sample and subject data files as 'samples data' or 'subject data', respectively.
   <table style="width:100%" align="center">
   <tr>
    <th>Metadata</th>
    <th>Data</th>
   </tr>
   <tr>
    <td>Age</td>
    <td>Samples Data</td>
   </tr>
   <tr>
    <td>Genotype</td>
    <td>Samples Data</td>
   </tr>
   <tr>
    <td>Subject ID</td>
    <td>Samples Data</td>
   </tr>
   <tr>
    <td>Sex</td>
    <td>Samples Data</td>
   </tr>
   <tr>
    <td>Weight</td>
    <td>Subject Data</td>
   </tr>
   <tr>
    <td>Species</td>
    <td>Samples Data</td>
   </tr>
   <tr>
    <td>Description</td>
    <td>Samples Data</td>
   </tr>
  </table> 
  </li>
</ol>
</li>
<li>Additional metadata including session description, identifier, session start time, file creation date, institution, lab, experimenter, experiment description, related publications, and keywords were added to the NWB File.
<ol>
  <li>Institution and Lab records were left blank because of lack of information.</li>
  <li>The above information is manually retrieved from the experiment website.</li>
</ol>
</li>
<li>Finally, neural activitation and electrode data were included in the conversion.
<ol>
  <li>The information about electrodes includes - x, y, and z co-ordinates, location, and group of the electrode.</li>
  <li>The information about time series includes - name, description, and the data itself.</li>
</ol>
<li>
A log file will be generated by the python script, which has been included in this Github repository. The log file can be used to debug the code and check for the presence of files in the required template.
</li>
<li>
  Finally, the NWB files are created in the folder named `nwb_files/date_name` where 'date_name' is provided by the user.
</li>
<li>
  Updates to neural activation data within the existing NWB file are automated- the user is not required to change the script to add this type of data. However, the user is required to change and re-run the script according to NWB documentation to add other types of (meta)data to an existing NWB file.
</li>
  
Below, we tabulated the information about the NWB containers and the data placed in them so that the user understands where the data is located within the file. Reamining data containers were left untouched for this dataset.

NWB Container | Data
------------- | ----
acquisition/events | Neural Activity Data
general_extracellular_ephys/electrodes | Electrodes Data
general_subject | Subject Metadata
intervals/trials | timestamp Metadata

</ol>


## SPARC2NWB Team
[Marielle Darwin](https://github.com/mldarwin) | [Ananth Reddy](https://github.com/anbhimi) | [Derek Chang](https://github.com/DerekYJC) | [Patrick Chuang](https://github.com/lifestrugglee)

[contributors-shield]: https://img.shields.io/github/contributors/SPARC-FAIR-Codeathon/sparc2nwb.svg?style=flat-square
[contributors-url]: https://github.com/SPARC-FAIR-Codeathon/sparc2nwb/graphs/contributors
[stars-shield]: https://img.shields.io/github/stars/SPARC-FAIR-Codeathon/sparc2nwb.svg?style=flat-square
[stars-url]: https://github.com/SPARC-FAIR-Codeathon/sparc2nwb/stargazers
[issues-shield]: https://img.shields.io/github/issues/SPARC-FAIR-Codeathon/sparc2nwb.svg?style=flat-square
[issues-url]: https://github.com/SPARC-FAIR-Codeathon/sparc2nwb/issues
[license-shield]: https://img.shields.io/github/license/SPARC-FAIR-Codeathon/sparc2nwb.svg?style=flat-square
[license-url]: https://github.com/SPARC-FAIR-Codeathon/sparc2nwb/blob/main/LICENSE
